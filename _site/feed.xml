<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Comparative methods in R - Ilhabela</title>
    <description>Materials for R course.</description>
    <link>http://lukejharmon.github.io/ilhabela/ilhabela/</link>
    <atom:link href="http://lukejharmon.github.io/ilhabela/ilhabela/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Course logistics</title>
        <description>&lt;h2 id=&quot;basic-course-information&quot;&gt;Basic course information&lt;/h2&gt;

&lt;p&gt;Hello students and TAs. This is the course website for Macroevolution in R 2015,
taking place on Ilhabela from 1 to 6 July 2015.&lt;/p&gt;

&lt;p&gt;You should have already recieved information about traveling to Ilhabela and
food and housing while you are there.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;We are not able to offer you any travel support to attend the course. However, as you know, the workshop is free of
charge and we do offer the following: free shared accommodation (two students per room) at the &lt;a href=&quot;http://www.ilhaflat.com&quot;&gt;Hotel Ilha Flata&lt;/a&gt; in Ilhabela, Sao Paulo State, Brazil for Jul. 1-6; free breakfast, lunch, &amp;amp; coffee breaks
every course day (Jul. 2, 3, 4, &amp;amp; 5); free dinner on one night (date TBD, probably Jul. 5); and, for those &amp;gt;
attending the Evolution Conference in Guaruj√°, a free shuttle bus from the conference venue to Hotel Ilha Flat. If
you are not attending Evolution you will be responsible for all your travel arrangements to and from Ihla Bela. All
students will be responsible for their own travel arrangements home after the workshop.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;code-resources&quot;&gt;Code resources&lt;/h2&gt;

&lt;p&gt;Checkout the class &lt;a href=&quot;https://github.com/lukejharmon/ilhabela&quot;&gt;Github repository&lt;/a&gt;, which will be updated over the next few weeks.&lt;/p&gt;
</description>
        <pubDate>Tue, 02 Jun 2015 00:00:00 -0700</pubDate>
        <link>http://lukejharmon.github.io/ilhabela/ilhabela/information/2015/06/02/welcome-to-the-course/</link>
        <guid isPermaLink="true">http://lukejharmon.github.io/ilhabela/ilhabela/information/2015/06/02/welcome-to-the-course/</guid>
      </item>
    
      <item>
        <title>Diversification models</title>
        <description>&lt;p&gt;We will now study diversification models, including birth-death models and models where diversification rates depend on characters.&lt;/p&gt;

&lt;p&gt;We can start by considering a very simple model, the pure-birth model. Under a pure-birth model, lineages accumulate by speciation (there is no extinction) at a constant per-lineage rate lambda.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ape&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;TreeSim&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: geiger
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diversitree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: deSolve
## Loading required package: subplex
## Loading required package: Rcpp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;laser&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# We can use TreeSim to simulate a tree under a pure birth model we will use&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# TreeSim and, for now, simulate trees of a fixed age (but varying numbers&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# of taxa)&lt;/span&gt;

simTree1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-11.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# notice that if we repeat this command we get a different tree&lt;/span&gt;

simTree2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-12.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# the pattern of lineage accumulation through time for a tree can be&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# visualized with a Lineage-through-time plot&lt;/span&gt;

ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-13.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# ok - but we should always log the y-axis for ltt plots&lt;/span&gt;
ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-14.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-15.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# What is the distribution of tree size under a pure-birth model?&lt;/span&gt;
ntips &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;numeric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    st &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# rarely, there will be only one tip, and the function will return &amp;#39;1&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;st&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        ntips&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt; ntips&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;st&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;tip.label&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

hist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ntips&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-16.png&quot; alt=&quot;plot of chunk unnamed-chunk-1&quot;&gt;&lt;/p&gt;

&lt;p&gt;It is worth showing the shape of LTT plots under a pure-birth model. To simplify this, we can fix both the age of the clade and the number of taxa. To make this work with TreeSim, we should choose a value of lambda that satisfies the expected relationship under a pure-birth model, E[n(t)] = 2 exp(lambda * t). So if we choose t = 10 and lambda = 0.4, as above, then E[N(t)] = 2 exp(0.4 * 10) = about 109 tips.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;allTheTrees &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mrca &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    ltt.lines&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-2.png&quot; alt=&quot;plot of chunk unnamed-chunk-2&quot;&gt;&lt;/p&gt;

&lt;p&gt;So, under a pure-birth model, we expect the lineage-through-time plot to be linear on a log scale. What if we add extinction?&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;allTheTrees2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mrca &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees2&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    ltt.lines&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees2&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-3.png&quot; alt=&quot;plot of chunk unnamed-chunk-3&quot;&gt;&lt;/p&gt;

&lt;p&gt;Extinction leaves a signature in the shape of phylogenetic trees. We can see that in the lineage-through-time plot, which bends up towards the present day. We can also see this in the trees themselves:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;simTree1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
simTree2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfcol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; main &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Pure Birth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; main &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Birth-death&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-4.png&quot; alt=&quot;plot of chunk unnamed-chunk-4&quot;&gt;&lt;/p&gt;

&lt;p&gt;One important thing to keep in mind with diversification rate analysis is that sampling can be critical. To see why, let&amp;rsquo;s use simulations of partially sampled data:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;simTree1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
simTree2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    frac &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfcol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; main &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Fully sampled&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; main &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Partially sampled&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-5.png&quot; alt=&quot;plot of chunk unnamed-chunk-5&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# what is the general pattern?&lt;/span&gt;

allTheTrees3 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.taxa.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mrca &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; frac &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;109&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot.new&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
ltt.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees3&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; log &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    ltt.lines&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;allTheTrees3&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;i&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-6.png&quot; alt=&quot;plot of chunk unnamed-chunk-6&quot;&gt;&lt;/p&gt;

&lt;h1&gt; Estimating speciation and extinction rates &lt;/h1&gt;

&lt;p&gt;We can estimate speciation and extinction rates from phylogenetic trees by fitting the models described above, pure-birth and birth-death. We will use diversitree so that we can start to figure out how it works.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;simTree1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sim.bd.age&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;age &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numbsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# first fit a Yule model&lt;/span&gt;
pbModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; make.yule&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
pbMLFit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; find.mle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# next fit a Birth-death model&lt;/span&gt;
bdModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; make.bd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
bdMLFit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; find.mle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bdModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; method &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;optim&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lower &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# compare models&lt;/span&gt;
anova&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bdMLFit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pure.birth &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; pbMLFit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##            Df lnLik   AIC ChiSq Pr(&amp;gt;|Chi|)
## full        2  39.4 -74.7
## pure.birth  1  38.7 -75.3  1.43       0.23
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The beauty of diversitree is that we can very easily run a Bayesian analysis of diversification rates.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;bdSamples &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcmc&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bdModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; bdMLFit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;par&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nsteps &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1e+05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lower &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; upper &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;kc&quot;&gt;Inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; w &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fail.value &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;Inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; print.every &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 10000: {0.7066, 0.4345} -&amp;gt; 38.23901
## 20000: {0.6983, 0.4807} -&amp;gt; 38.61153
## 30000: {0.4707, 0.1993} -&amp;gt; 39.34786
## 40000: {0.3968, 0.0109} -&amp;gt; 38.59093
## 50000: {0.5818, 0.5375} -&amp;gt; 37.45965
## 60000: {0.7548, 0.3742} -&amp;gt; 36.23272
## 70000: {0.5073, 0.2229} -&amp;gt; 39.27743
## 80000: {0.7477, 0.5798} -&amp;gt; 38.32425
## 90000: {0.4992, 0.2517} -&amp;gt; 39.36961
## 100000: {0.4649, 0.2432} -&amp;gt; 39.27638
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;postSamples &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; bdSamples&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lambda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;mu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
profiles.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;postSamples&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; col.line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; las &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; legend &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;topright&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-81.png&quot; alt=&quot;plot of chunk unnamed-chunk-8&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# often estimates of r (= lambda-mu) are more precise than either lambda and&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# mu&lt;/span&gt;
postSamples&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;r &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bdSamples&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; mu&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
postSamples&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;eps &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bdSamples&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;lambda&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

profiles.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;postSamples&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;eps&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; col.line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; las &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    legend &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;topright&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-82.png&quot; alt=&quot;plot of chunk unnamed-chunk-8&quot;&gt;&lt;/p&gt;

&lt;h1&gt; Testing for slowdowns &lt;/h1&gt;

&lt;p&gt;We can test for slowdowns in the rate of diversification through time using both Pybus and Harvey&amp;rsquo;s gamma - a very common test in the literature - and likelihood using Rabosky&amp;rsquo;s approach.&lt;/p&gt;

&lt;p&gt;We can start with gamma:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# let&amp;#39;s try our simulated tree&lt;/span&gt;
gs &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; gammaStat&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
mccrResult &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mccrTest&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;CladeSize &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simTree1&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;tip.label&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; NumberMissing &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    NumberOfReps &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ObservedGamma &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; gs&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# now let&amp;#39;s try the anole tree. This tree is incomplete, so we have to&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# account for that.&lt;/span&gt;
gsAnole &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; gammaStat&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error: object &amp;#39;anoleTree&amp;#39; not found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mccrResultAnole &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mccrTest&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;CladeSize &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;tip.label&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; NumberMissing &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    NumberOfReps &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ObservedGamma &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; gsAnole&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error: object &amp;#39;anoleTree&amp;#39; not found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# we can use likelihood to compare a set of models for diversification. This&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# REQUIRES a complete tree, which we do not have - so these results are&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# incorrect&lt;/span&gt;

anoleBTimes &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;branching.times&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; decreasing &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error: object &amp;#39;anoleTree&amp;#39; not found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fitdAICrc&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleBTimes&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; modelset &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;pureBirth&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;bd&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;DDX&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;DDL&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;yule2rate&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    ints &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error: object &amp;#39;anoleBTimes&amp;#39; not found
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt; Relating diversification rates to character state &lt;/h1&gt;

&lt;p&gt;We can test for a relationship between character state and diversification rates using BiSSE (and related approaches). The syntax for BiSSE is consistent with other aspects of diversitree that we learned above. We will try this with anole ecomorph data. BiSSE can only handle binary traits, so we will have to change our data over to a binary (0-1) character.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# let&amp;#39;s try a simulated data set to see if we can really detect a true&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# effect&lt;/span&gt;

simPars &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
simBisseData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tree.bisse&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simPars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; max.t &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x0 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

hist &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; history.from.sim.discrete&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simBisseData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hist&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; simBisseData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-101.png&quot; alt=&quot;plot of chunk unnamed-chunk-10&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;nbModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; make.bisse&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simBisseData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; simBisseData&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;tip.state&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
p &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; starting.point.bisse&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;simBisseData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
nbModelMLFit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; find.mle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;rbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;real &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; simPars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; estimated &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nbModelMLFit&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##           lambda0 lambda1  mu0  mu1  q01  q10
## real          0.4    0.20 0.05 0.05 0.05 0.05
## estimated     0.4    0.23 0.00 0.47 0.14 0.00
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# we can test a constrained model where the character does not affect&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# diversification rates&lt;/span&gt;

cnbModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; constrain&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; lambda1 &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; lambda0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
cnbModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; constrain&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cnbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu1 &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; mu0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

cnbModelMLFit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; find.mle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cnbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; p&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# compare models&lt;/span&gt;

anova&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nbModelMLFit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; constrained &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cnbModelMLFit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##             Df lnLik AIC ChiSq Pr(&amp;gt;|Chi|)
## full         6  -212 437
## constrained  4  -214 436  2.63       0.27
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# let&amp;#39;s try a Bayesian analysis&lt;/span&gt;

prior &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; make.prior.exponential&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# this is not long enough but ok for now. You might want more like 1000000&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# generations.&lt;/span&gt;
mcmcRun &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mcmc&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nbModel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nbModelMLFit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;par&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nsteps &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; prior &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; prior&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; w &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    print.every &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 100: {0.4764, 0.2365, 0.1580, 0.4976, 0.1726, 0.0994} -&amp;gt; -214.90686
## 200: {0.5063, 0.2716, 0.0322, 0.2143, 0.1433, 0.2130} -&amp;gt; -215.33748
## 300: {0.5721, 0.5181, 0.4216, 0.1710, 0.1484, 0.6746} -&amp;gt; -219.73947
## 400: {0.4758, 0.1728, 0.0528, 0.0562, 0.1831, 0.4297} -&amp;gt; -214.32404
## 500: {0.4167, 0.4111, 0.0252, 0.5534, 0.2293, 0.4296} -&amp;gt; -215.97337
## 600: {0.2608, 0.3070, 0.0342, 0.2933, 0.2619, 0.3821} -&amp;gt; -222.18071
## 700: {0.4375, 0.7609, 0.1531, 0.5333, 0.8031, 2.9827} -&amp;gt; -225.98707
## 800: {0.4527, 0.1641, 0.3006, 0.3028, 0.0885, 0.0087} -&amp;gt; -218.23327
## 900: {0.4327, 0.2812, 0.1906, 0.1734, 0.1400, 0.3540} -&amp;gt; -215.15756
## 1000: {0.4310, 0.2367, 0.0852, 0.4269, 0.1284, 0.0251} -&amp;gt; -213.39588
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;col &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
profiles.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lambda0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;lambda1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; col.line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; las &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; legend &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;topright&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-102.png&quot; alt=&quot;plot of chunk unnamed-chunk-10&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;profiles.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;mu0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;mu1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; col.line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; las &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; legend &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;topright&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/bd/unnamed-chunk-103.png&quot; alt=&quot;plot of chunk unnamed-chunk-10&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# looks like speciation rate differs, but not extinction. can we confirm?&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;lambda0 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;lambda1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;lambda1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.875
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;mu0 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;mu1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mcmcRun&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;mu1&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.212
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt; Challenge problem &lt;/h1&gt;

&lt;p&gt;Repeat the above analyses with anoles (using the trait below). Fit a BiSSE model using both ML and Bayesian methods. What do you conclude?&lt;/p&gt;

&lt;p&gt;You need a binary trait, so use the following:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;anoleData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;~/Documents/teaching/revellClass/2014bogota/continuousModels/anolisDataAppended.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    row.names &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
anoleTree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;~/Documents/teaching/revellClass/2014bogota/continuousModels/anolis.phy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ecomorph &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; anoleData&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ecomorph&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ecomorph&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

isTG &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.numeric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ecomorph &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;TG&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;isTG&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ecomorph&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
isTG
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##            ahli         alayoni         alfaroi        aliniger
##               1               0               0               0
##        allisoni         allogus   altitudinalis         alumina
##               0               1               0               0
##       alutaceus     angusticeps     argenteolus     argillaceus
##               0               0               0               0
##         armouri   bahorucoensis        baleatus        baracoae
##               1               0               0               0
##       barahonae        barbatus        barbouri        bartschi
##               0               0               0               0
##         bremeri        breslini    brevirostris        caudalis
##               1               1               0               0
##       centralis  chamaeleonides    chlorocyanus     christophei
##               0               0               0               0
##       clivicola     coelestinus        confusus           cooki
##               0               0               1               1
##    cristatellus    cupeyalensis         cuvieri    cyanopleurus
##               1               0               0               0
##         cybotes     darlingtoni       distichus dolichocephalus
##               1               0               0               0
##       equestris      etheridgei   eugenegrahami       evermanni
##               0               0               0               0
##         fowleri         garmani         grahami           guafe
##               0               0               0               1
##       guamuhaya         guazuma       gundlachi       haetianus
##               0               0               1               1
##      hendersoni      homolechis           imias    inexpectatus
##               0               1               1               0
##       insolitus        isolepis           jubar           krugi
##               0               0               1               0
##      lineatopus   longitibialis        loysiana          lucius
##               1               1               0               0
##    luteogularis      macilentus        marcanoi          marron
##               0               0               1               0
##         mestrei       monticola          noblei        occultus
##               1               0               0               0
##         olssoni        opalinus      ophiolepis        oporinus
##               0               0               0               0
##        paternus        placidus       poncensis        porcatus
##               0               0               0               0
##          porcus      pulchellus         pumilis quadriocellifer
##               0               0               0               1
##      reconditus        ricordii     rubribarbus          sagrei
##               0               0               1               1
##    semilineatus        sheplani         shrevei      singularis
##               0               0               1               0
##      smallwoodi         strahmi       stratulus     valencienni
##               0               1               0               0
##       vanidicus    vermiculatus        websteri       whitemani
##               0               0               0               1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        <pubDate>Tue, 02 Jun 2015 00:00:00 -0700</pubDate>
        <link>http://lukejharmon.github.io/ilhabela/ilhabela/instruction/2015/06/02/diversification/</link>
        <guid isPermaLink="true">http://lukejharmon.github.io/ilhabela/ilhabela/instruction/2015/06/02/diversification/</guid>
      </item>
    
      <item>
        <title>Models of continuous character evolution</title>
        <description>&lt;p&gt;Let&amp;rsquo;s fit some models of continuous character evolution. First, we will learn how to do some tests of &amp;ldquo;phylogenetic signal,&amp;rdquo; a very common test especially for ecological analyses. Then we will learn how to fit a series of evolutionary models for continuous characters.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;geiger&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: ape
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;picante&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: vegan
## Loading required package: permute
## Loading required package: lattice
## This is vegan 2.0-10
## Loading required package: nlme
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;phytools&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: maps
## Loading required package: rgl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: failed to assign RegisteredNativeSymbol for getData to getData
## since getData is already defined in the &amp;#39;phangorn&amp;#39; namespace
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We will use the same anolis data and phylogenetic tree from previous exercises. If you don&amp;rsquo;t already have them, you can download the files from the following addresses:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/0B9R4DAZPUvjiV2VhTUxOTlRuQUU/edit?usp=sharing&quot;&gt;anolisDataAppended.csv&lt;/a&gt; &lt;br&gt;
&lt;a href=&quot;https://drive.google.com/file/d/0B9R4DAZPUvjiSkl1aFY2TkNMVFk/edit?usp=sharing&quot;&gt;anolis.phy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you need to, make sure these files are in your working directory and read them in.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;anoleData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;anolisDataAppended.csv&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; row.names &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
anoleTree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; read.tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;anolis.phy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you have the data, then the following commands should work:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/cc1.png&quot; alt=&quot;plot&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;name.check&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] &amp;quot;OK&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;rsquo;s do the two main tests for phylogenetic signal using anole body size. The first test is Blomberg&amp;rsquo;s K, which compares the variance of PICs to what we would espect under a Brownian motion model. K = 1 means that relatives resemble one another as much as we should expect under BM; K &amp;lt; 1 means that there is less &amp;ldquo;phylogenetic signal&amp;rdquo; than expected under BM, while K &amp;gt; 1 means that there is more. A significant p-value returned from phylosignal tells you that there is significant phylogenetic signal - that is, close relatives are more similar than random pairs of species.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;anoleSize &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; anoleData&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
phylosignal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleTree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##       K PIC.variance.obs PIC.variance.rnd.mean PIC.variance.P
## 1 1.554           0.1389                 0.773          0.001
##   PIC.variance.Z
## 1         -3.913
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;phylosig&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; method &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;K&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; test &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## $K
## [1] 1.554
##
## $P
## [1] 0.001
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Another method for testing phylogenetic signal is Pagel&amp;rsquo;s lambda. Lambda is a tree transformation that stretches tip branches relative to internal branches, making the tree more and more like a complete polytomy. If our estimated lambda = 0, then the traits are inferred to have no phylogenetic signal. Lambda = 1 corresponds to a Brownian motion model; 0 &amp;lt; lambda &amp;lt; 1 is in between.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# First let&amp;#39;s look at what lambda does&lt;/span&gt;
anoleTreeLambda0 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rescale&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;lambda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
anoleTreeLambda5 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; rescale&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;lambda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfcol &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTreeLambda5&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTreeLambda0&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/ilhabela/images/cc2.png&quot; alt=&quot;plot&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;phylosig&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; method &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;lambda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; test &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## $lambda
## [1] 1.017
##
## $logL
## [1] -3.81
##
## $logL0
## [1] -60.02
##
## $P
## [1] 2.893e-26
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;lambdaModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;lambda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Loading required package: parallel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning: Parameter estimates appear at bounds:
##  lambda
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;brownianModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
nosigModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTreeLambda0&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

lambdaModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 15.65
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;brownianModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 13.52
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;nosigModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 124.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Conclusion: Brownian model is best, no signal model is terrible&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can use fitContinuous to fit OU and EB models as well.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;brownianModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
OUModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;OU&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
EBModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;EB&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# inspect results&lt;/span&gt;
brownianModel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## GEIGER-fitted comparative model of continuous data
##  fitted &amp;#39;BM&amp;#39; model parameters:
##  sigsq = 0.136160
##  z0 = 4.065918
##
##  model summary:
##  log-likelihood = -4.700404
##  AIC = 13.400807
##  AICc = 13.524519
##  free parameters = 2
##
## Convergence diagnostics:
##  optimization iterations = 100
##  failed iterations = 0
##  frequency of best fit = 1.00
##
##  object summary:
##  &amp;#39;lik&amp;#39; -- likelihood function
##  &amp;#39;bnd&amp;#39; -- bounds for likelihood search
##  &amp;#39;res&amp;#39; -- optimization iteration summary
##  &amp;#39;opt&amp;#39; -- maximum likelihood parameter estimates
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;OUModel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## GEIGER-fitted comparative model of continuous data
##  fitted &amp;#39;OU&amp;#39; model parameters:
##  alpha = 0.000000
##  sigsq = 0.136160
##  z0 = 4.065918
##
##  model summary:
##  log-likelihood = -4.700404
##  AIC = 15.400807
##  AICc = 15.650807
##  free parameters = 3
##
## Convergence diagnostics:
##  optimization iterations = 100
##  failed iterations = 0
##  frequency of best fit = 0.76
##
##  object summary:
##  &amp;#39;lik&amp;#39; -- likelihood function
##  &amp;#39;bnd&amp;#39; -- bounds for likelihood search
##  &amp;#39;res&amp;#39; -- optimization iteration summary
##  &amp;#39;opt&amp;#39; -- maximum likelihood parameter estimates
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;EBModel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## GEIGER-fitted comparative model of continuous data
##  fitted &amp;#39;EB&amp;#39; model parameters:
##  a = -0.736271
##  sigsq = 0.233528
##  z0 = 4.066519
##
##  model summary:
##  log-likelihood = -4.285970
##  AIC = 14.571939
##  AICc = 14.821939
##  free parameters = 3
##
## Convergence diagnostics:
##  optimization iterations = 100
##  failed iterations = 0
##  frequency of best fit = 0.41
##
##  object summary:
##  &amp;#39;lik&amp;#39; -- likelihood function
##  &amp;#39;bnd&amp;#39; -- bounds for likelihood search
##  &amp;#39;res&amp;#39; -- optimization iteration summary
##  &amp;#39;opt&amp;#39; -- maximum likelihood parameter estimates
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# calculate AIC weights&lt;/span&gt;
bmAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; brownianModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
ouAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; OUModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
ebAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; EBModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc

aicc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bmAICC&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ouAICC&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ebAICC&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccD &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; aicc &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aicc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aw &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; aiccD&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccW &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; aw&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aw&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccW
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.5353 0.1849 0.2798
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It is important to realize that measurement error can bias your inferences with fitting these models towards OU. Fortunately, we can easily account for that in fitContinuous.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# We measured 20 anoles per species, and the standard deviation within each&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# species was, on average, 0.05&lt;/span&gt;
seSize &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.05&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# redo with measurement error&lt;/span&gt;
brownianModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; SE &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; seSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
OUModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;OU&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; SE &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; seSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
EBModel &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fitContinuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;anoleTree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; anoleSize&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; model &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;EB&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; SE &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; seSize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# calculate AIC weights&lt;/span&gt;
bmAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; brownianModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
ouAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; OUModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc
ebAICC &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; EBModel&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;opt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;aicc

aicc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;bmAICC&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ouAICC&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ebAICC&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccD &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; aicc &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aicc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aw &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-0.5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; aiccD&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccW &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; aw&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aw&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
aiccW
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## [1] 0.5346 0.1846 0.2808
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
        <pubDate>Tue, 02 Jun 2015 00:00:00 -0700</pubDate>
        <link>http://lukejharmon.github.io/ilhabela/ilhabela/instruction/2015/06/02/ContinuousModels/</link>
        <guid isPermaLink="true">http://lukejharmon.github.io/ilhabela/ilhabela/instruction/2015/06/02/ContinuousModels/</guid>
      </item>
    
  </channel>
</rss>
